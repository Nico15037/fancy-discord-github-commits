name: Discord Webhook Workflow

on:
  push:
    branches: [ main ]

jobs:
  test-webhook:
    runs-on: ubuntu-latest

    steps:
      - name: Discord notification
        uses: Ilshidur/action-discord@master
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
          DISCORD_USERNAME: "THEY'RE ABOUT TO KNOW"
          DISCORD_AVATAR: "https://www.farawaymoon.com/wp-content/uploads/fancy-discord-github-commits-guide-cover.png"
          DISCORD_EMBEDS: ${{ toJson([{
            "title": "give up haggling with fate, friend",
            "description": "${{ github.event.head_commit.message }}",
            "color": ${{ secrets.EMBED_COLOR }}
          }]) }}
        with:
          args: ""
